<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
    <!-- Title -->
    <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">Figure 4: Phase-Dependent Quantum Coherence Oscillations</text>

    <!-- Panel A: Experimental Setup Schematic -->
    <rect x="50" y="60" width="700" height="160" fill="#f8f8f8" stroke="#333" stroke-width="1" />
    <text x="400" y="80" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Panel A: Experimental Setup Schematic</text>

    <!-- Initial state preparation -->
    <rect x="100" y="120" width="80" height="40" fill="#9fc5e8" stroke="#333" stroke-width="2" rx="5" ry="5" />
    <text x="140" y="145" font-family="Arial" font-size="14" text-anchor="middle">|ψ₀⟩</text>
    
    <!-- XOR Operation Module -->
    <rect x="230" y="120" width="80" height="40" fill="#b6d7a8" stroke="#333" stroke-width="2" rx="5" ry="5" />
    <text x="270" y="145" font-family="Arial" font-size="14" text-anchor="middle">XOR</text>
    
    <!-- Phase Rotation Module -->
    <rect x="360" y="120" width="80" height="40" fill="#d5a6bd" stroke="#333" stroke-width="2" rx="5" ry="5" />
    <text x="400" y="135" font-family="Arial" font-size="14" text-anchor="middle">Phase</text>
    <text x="400" y="155" font-family="Arial" font-size="14" text-anchor="middle">e^(iθ)</text>
    
    <!-- Sequential Control -->
    <rect x="490" y="120" width="120" height="40" fill="#ffe599" stroke="#333" stroke-width="2" rx="5" ry="5" />
    <text x="550" y="135" font-family="Arial" font-size="14" text-anchor="middle">Sequential</text>
    <text x="550" y="155" font-family="Arial" font-size="14" text-anchor="middle">Operation (n)</text>

    <!-- Connecting lines -->
    <line x1="180" y1="140" x2="230" y2="140" stroke="#333" stroke-width="2" />
    <line x1="310" y1="140" x2="360" y2="140" stroke="#333" stroke-width="2" />
    <line x1="440" y1="140" x2="490" y2="140" stroke="#333" stroke-width="2" />
    <line x1="610" y1="140" x2="650" y2="140" stroke="#333" stroke-width="2" />
    
    <!-- Feedback loop -->
    <path d="M550,160 Q550,190 400,190 Q250,190 250,160" stroke="#333" stroke-width="1.5" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowhead)" />
    <text x="400" y="205" font-family="Arial" font-size="12" text-anchor="middle">Repeat n times</text>

    <!-- Panel B: Circuit Diagram -->
    <rect x="50" y="240" width="700" height="120" fill="#f8f8f8" stroke="#333" stroke-width="1" />
    <text x="400" y="260" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Panel B: Quantum Circuit Diagram</text>

    <!-- Circuit elements -->
    <!-- Initial state prep -->
    <line x1="100" y1="300" x2="700" y2="300" stroke="#aaa" stroke-width="1" />
    <rect x="120" y="290" width="60" height="20" fill="#9fc5e8" stroke="#333" stroke-width="1" />
    <text x="150" y="305" font-family="Arial" font-size="10" text-anchor="middle">Prep |ψ₀⟩</text>
    
    <!-- Repeating blocks -->
    <rect x="210" y="280" width="380" height="40" stroke="#333" stroke-width="1" stroke-dasharray="5,3" fill="none" />
    
    <!-- XOR gates -->
    <rect x="230" y="290" width="40" height="20" fill="#b6d7a8" stroke="#333" stroke-width="1" />
    <text x="250" y="305" font-family="Arial" font-size="10" text-anchor="middle">X_R</text>
    
    <rect x="330" y="290" width="40" height="20" fill="#b6d7a8" stroke="#333" stroke-width="1" />
    <text x="350" y="305" font-family="Arial" font-size="10" text-anchor="middle">X_R</text>
    
    <rect x="430" y="290" width="40" height="20" fill="#b6d7a8" stroke="#333" stroke-width="1" />
    <text x="450" y="305" font-family="Arial" font-size="10" text-anchor="middle">X_R</text>
    
    <rect x="530" y="290" width="40" height="20" fill="#b6d7a8" stroke="#333" stroke-width="1" />
    <text x="550" y="305" font-family="Arial" font-size="10" text-anchor="middle">X_R</text>
    
    <!-- Phase gates -->
    <rect x="280" y="290" width="40" height="20" fill="#d5a6bd" stroke="#333" stroke-width="1" />
    <text x="300" y="305" font-family="Arial" font-size="10" text-anchor="middle">e^(iθ)</text>
    
    <rect x="380" y="290" width="40" height="20" fill="#d5a6bd" stroke="#333" stroke-width="1" />
    <text x="400" y="305" font-family="Arial" font-size="10" text-anchor="middle">e^(iθ)</text>
    
    <rect x="480" y="290" width="40" height="20" fill="#d5a6bd" stroke="#333" stroke-width="1" />
    <text x="500" y="305" font-family="Arial" font-size="10" text-anchor="middle">e^(iθ)</text>
    
    <!-- Measurement -->
    <rect x="640" y="290" width="40" height="20" fill="#ea9999" stroke="#333" stroke-width="1" />
    <text x="660" y="305" font-family="Arial" font-size="10" text-anchor="middle">Measure</text>
    
    <!-- Circuit labels -->
    <text x="400" y="335" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">n iterations of (e^(iθ)·X_R)</text>

    <!-- Panel C: Coherence Oscillation Patterns -->
    <rect x="50" y="380" width="700" height="200" fill="#f8f8f8" stroke="#333" stroke-width="1" />
    <text x="400" y="400" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Panel C: Coherence Oscillation Patterns</text>

    <!-- Graph axes -->
    <line x1="100" y1="520" x2="650" y2="520" stroke="#333" stroke-width="2" /> <!-- X-axis -->
    <line x1="100" y1="520" x2="100" y2="420" stroke="#333" stroke-width="2" /> <!-- Y-axis -->
    
    <!-- Axis labels -->
    <text x="375" y="545" font-family="Arial" font-size="14" text-anchor="middle">Number of Sequential Operations (n)</text>
    <text x="70" y="470" font-family="Arial" font-size="14" text-anchor="middle" transform="rotate(-90, 70, 470)">Quantum Coherence C(n)</text>
    
    <!-- X-axis ticks -->
    <line x1="100" y1="520" x2="100" y2="525" stroke="#333" stroke-width="1" />
    <text x="100" y="535" font-family="Arial" font-size="10" text-anchor="middle">0</text>
    
    <line x1="210" y1="520" x2="210" y2="525" stroke="#333" stroke-width="1" />
    <text x="210" y="535" font-family="Arial" font-size="10" text-anchor="middle">10</text>
    
    <line x1="320" y1="520" x2="320" y2="525" stroke="#333" stroke-width="1" />
    <text x="320" y="535" font-family="Arial" font-size="10" text-anchor="middle">20</text>
    
    <line x1="430" y1="520" x2="430" y2="525" stroke="#333" stroke-width="1" />
    <text x="430" y="535" font-family="Arial" font-size="10" text-anchor="middle">30</text>
    
    <line x1="540" y1="520" x2="540" y2="525" stroke="#333" stroke-width="1" />
    <text x="540" y="535" font-family="Arial" font-size="10" text-anchor="middle">40</text>
    
    <line x1="650" y1="520" x2="650" y2="525" stroke="#333" stroke-width="1" />
    <text x="650" y="535" font-family="Arial" font-size="10" text-anchor="middle">50</text>
    
    <!-- Y-axis ticks -->
    <line x1="95" y1="520" x2="100" y2="520" stroke="#333" stroke-width="1" />
    <text x="90" y="525" font-family="Arial" font-size="10" text-anchor="end">0.0</text>
    
    <line x1="95" y1="470" x2="100" y2="470" stroke="#333" stroke-width="1" />
    <text x="90" y="475" font-family="Arial" font-size="10" text-anchor="end">0.5</text>
    
    <line x1="95" y1="420" x2="100" y2="420" stroke="#333" stroke-width="1" />
    <text x="90" y="425" font-family="Arial" font-size="10" text-anchor="end">1.0</text>
    
    <!-- Coherence curves for different phase angles -->
    <!-- θ = π/4 (blue) -->
    <path d="M100,420 C110,422 120,425 130,430 S150,442 160,455 S180,475 190,485 S210,498 220,505 S240,512 250,515 S270,517 280,516 S300,512 310,506 S330,492 340,484 S360,470 370,462 S390,450 400,445 S420,440 430,442 S450,450 460,455 S480,470 490,478 S510,495 520,505 S540,517 550,518 S570,512 580,508 S600,492 610,478 S630,455 640,442 S650,422 650,420" 
          stroke="#0000ff" stroke-width="2.5" fill="none" />
    
    <!-- θ = π/3 (red) -->
    <path d="M100,420 C110,424 120,428 130,436 S150,450 160,464 S180,482 190,490 S210,496 220,498 S240,495 250,490 S270,480 280,470 S300,454 310,448 S330,442 340,440 S360,444 370,453 S390,472 400,485 S420,504 430,514 S450,520 460,518 S480,510 490,500 S510,478 520,465 S540,444 550,434 S570,430 580,440 S600,462 610,484 S630,514 640,520 S650,518 650,510" 
          stroke="#ff0000" stroke-width="2.5" fill="none" />
    
    <!-- θ = π/2 (green) -->
    <path d="M100,420 C110,426 120,432 130,442 S150,458 160,472 S180,486 190,495 S210,500 220,496 S240,484 250,470 S270,452 280,440 S300,430 310,438 S330,458 340,475 S360,495 370,510 S390,518 400,512 S420,492 430,478 S450,452 460,438 S480,424 490,428 S510,448 520,475 S540,502 550,518 S570,512 580,492 S600,462 610,438 S630,418 640,424 S650,454 650,482" 
          stroke="#00aa00" stroke-width="2.5" fill="none" />
    
    <!-- Standard QM prediction (dashed line) -->
    <path d="M100,420 C195,460 290,485 385,500 S575,510 650,510" 
          stroke="#333333" stroke-width="2" stroke-dasharray="5,3" fill="none" />
    
    <!-- Inset: Fourier transform -->
    <rect x="470" y="430" width="150" height="80" fill="white" stroke="#333" stroke-width="1" />
    <text x="545" y="445" font-family="Arial" font-size="10" text-anchor="middle" font-style="italic">Fourier Transform</text>
    
    <!-- Mini frequency spectrum -->
    <line x1="485" y1="500" x2="605" y2="500" stroke="#333" stroke-width="1" /> <!-- X-axis -->
    <line x1="485" y1="500" x2="485" y2="460" stroke="#333" stroke-width="1" /> <!-- Y-axis -->
    
    <!-- Frequency peaks -->
    <line x1="495" y1="500" x2="495" y2="490" stroke="#0000ff" stroke-width="1.5" />
    <line x1="535" y1="500" x2="535" y2="475" stroke="#ff0000" stroke-width="1.5" />
    <line x1="575" y1="500" x2="575" y2="465" stroke="#00aa00" stroke-width="1.5" />
    <text x="545" y="510" font-family="Arial" font-size="8" text-anchor="middle">Frequency (θ)</text>
    
    <!-- Legend -->
    <rect x="140" y="420" width="150" height="70" fill="white" stroke="#333" stroke-width="1" />
    <line x1="150" y1="435" x2="170" y2="435" stroke="#0000ff" stroke-width="2.5" />
    <text x="175" y="440" font-family="Arial" font-size="12">θ = π/4</text>
    <line x1="150" y1="455" x2="170" y2="455" stroke="#ff0000" stroke-width="2.5" />
    <text x="175" y="460" font-family="Arial" font-size="12">θ = π/3</text>
    <line x1="150" y1="475" x2="170" y2="475" stroke="#00aa00" stroke-width="2.5" />
    <text x="175" y="480" font-family="Arial" font-size="12">θ = π/2</text>
    
    <!-- Formula -->
    <text x="380" y="410" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">C(n) = C₀·cos(nθ + φ₀)·e^(-n/n₀)</text>

    <!-- Define arrowhead marker -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
        </marker>
    </defs>
</svg> 